# Dify .env 配置更新建议（使用服务器 Nginx）

# ============================================
# 域名配置
# ============================================
# 主域名
CONSOLE_API_URL=https://dify.agentsben.com
CONSOLE_WEB_URL=https://dify.agentsben.com
APP_API_URL=https://api.dify.agentsben.com
APP_WEB_URL=https://app.dify.agentsben.com
SERVICE_API_URL=https://api.dify.agentsben.com
FILES_URL=https://files.dify.agentsben.com

# ============================================
# 端口配置（使用服务器 Nginx，不需要暴露到外网）
# ============================================
# 不需要设置 EXPOSE_NGINX_PORT 和 EXPOSE_NGINX_SSL_PORT
# 因为已经移除了 Docker 中的 Nginx 容器

# ============================================
# 数据库配置
# ============================================
DB_TYPE=postgresql
DB_USERNAME=dify
DB_PASSWORD=PV6jQcSCAfwdXuz4CAJg5+nVyXqhBabdFp8CDT8r0LU=
DB_HOST=db_postgres
DB_PORT=5432
DB_DATABASE=dify

# ============================================
# Redis 配置（使用服务器已有的 Redis）
# ============================================
# 注意：需要确认 Redis 的实际 host 地址
# 如果 Redis 在宿主机上，使用 host.docker.internal 或宿主机 IP
# 如果 Redis 在其他容器中，使用容器名或服务名
REDIS_HOST=host.docker.internal
REDIS_PORT=6379
REDIS_USERNAME=default
REDIS_PASSWORD=sd@234#$dfSDwe23
REDIS_DB=0
REDIS_USE_SSL=false

# Celery Broker（使用相同的 Redis）
CELERY_BROKER_URL=redis://:sd@234#$dfSDwe23@host.docker.internal:6379/1

# ============================================
# 向量数据库配置（使用服务器已有的 Qdrant）
# ============================================
VECTOR_STORE=qdrant
# 如果 Qdrant 在宿主机上，使用 host.docker.internal
QDRANT_URL=http://host.docker.internal:6333
QDRANT_API_KEY=f3f8e23r45gh606-6c1a-4c34-8929-0352d4025302
QDRANT_CLIENT_TIMEOUT=30
QDRANT_GRPC_ENABLED=false
QDRANT_GRPC_PORT=6334

# ============================================
# 安全配置
# ============================================
SECRET_KEY=a9hkHgc4nmLbB2JyUH5nXoVDy8Ay4+viH13bzWt9jLZqg53cC2nD1AaH
PLUGIN_DAEMON_KEY=cUA80Mw7ijg+r3LeUhQkEeXqZf7ABXGeEe+vUlsJE2sI5P/rKKB7j2zk
PLUGIN_DIFY_INNER_API_KEY=ar3gJNjcqrJpiig1mdbWmKz7hd51h7LkaR303sJXzxquQjj+hyupNPMq
SANDBOX_API_KEY=dify-sandbox

# ============================================
# 存储配置
# ============================================
STORAGE_TYPE=opendal
OPENDAL_SCHEME=fs
OPENDAL_FS_ROOT=/app/api/storage

# ============================================
# Cookie 配置
# ============================================
COOKIE_DOMAIN=.agentsben.com
NEXT_PUBLIC_COOKIE_DOMAIN=.agentsben.com

# ============================================
# CORS 配置
# ============================================
WEB_API_CORS_ALLOW_ORIGINS=https://dify.agentsben.com,https://app.agentsben.com
CONSOLE_CORS_ALLOW_ORIGINS=https://dify.agentsben.com

# ============================================
# 性能优化
# ============================================
# 根据服务器配置调整
SERVER_WORKER_AMOUNT=2
CELERY_WORKER_AMOUNT=2
PM2_INSTANCES=2

# PostgreSQL 优化（根据服务器内存调整）
POSTGRES_SHARED_BUFFERS=256MB
POSTGRES_EFFECTIVE_CACHE_SIZE=1GB
POSTGRES_WORK_MEM=8MB
POSTGRES_MAINTENANCE_WORK_MEM=128MB

# ============================================
# 其他配置
# ============================================
LOG_LEVEL=INFO
DEPLOY_ENV=PRODUCTION
MIGRATION_ENABLED=true
